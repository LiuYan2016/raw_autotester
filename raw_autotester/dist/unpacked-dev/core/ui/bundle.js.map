{"version":3,"sources":["webpack:///./src/utils/messaging.js?3d1d","webpack:///./src/background/external-events.js?4d71","webpack:///./src/utils/logger.js?7f3f","webpack:///./src/ui/controllers/app.js","webpack:///./src/ui/controllers/bg-api.js","webpack:///./src/ui/controllers/window-api.js","webpack:///./src/ui/controllers/tests-run.js","webpack:///./src/ui/controllers/html-console.js","webpack:///./src/utils/console.js","webpack:///./~/json-stringify-safe/stringify.js","webpack:///./src/ui/controllers/setup.js","webpack:///./src/ui/state/defaults-extra.js","webpack:///./src/ui/controllers/config-loader.js","webpack:///./src/utils/evaluate.js"],"names":["mobx","require","fs","state","APP_STATE","bgApi","windowApi","testsRun","configLoader","htmlConsole","setup","editor","exports","start","init","Promise","resolve","then","type","window","PERSISTENT","requestQuota","applyOnFirstRun","load","action","ready","appState","READY","messaging","externalEvents","onTestsDone","onSessionStarted","onFileStarted","onTestStarted","RELOAD","TESTS_RUN","TESTS_DONE","SESSION_STARTED","FILE_STARTED","TEST_STARTED","registerEvents","on","location","reload","dispatch","data","runTests","send","Object","assign","runCustomSnippets","getInstance","resetDefaults","reset","report","document","getElementById","thenChrome","path","TAB","onTestsRun","onConsoleClear","addListener","runOnCurrentData","done","snippets","target","getSelectedTargetInfo","devMode","run","TESTS_RUNNING","selectedTab","REPORT","activateSelfTab","baseUrl","getBaseUrl","files","getFiles","isInnerFiles","getSnippets","selectedFile","filter","file","isSetup","map","concat","innerFilesPath","dirname","filesSourceUrl","basePath","paths","tasks","fullPath","readFile","code","all","selectedTarget","Error","hub","hubs","find","id","hubId","serverUrl","watchUrl","loopback","name","caps","tabs","getCurrent","tab","update","active","Console","onConsoleMessage","instance","onMessage","onClear","defaults","defaultsExtra","PROJECTS_DIR","logger","create","isFirstRun","firstRun","storeDefaults","clear","storage","local","setTimeout","get","keys","length","storeToStorage","storeToFs","toJS","installDate","Date","now","projects","project","selectedProjectId","targets","selectedTargetId","log","set","innerFile","content","writeFile","process","env","YANDEX_USER","YANDEX_KEY","SAUCE_USER","SAUCE_KEY","onError","utils","evaluate","reaction","url","isValidUrl","LOADING","fetchText","text","processConfig","fail","config","setupFiles","regularFiles","tests","outerFiles","e","asCommonJs","validateConfig","Array","isArray"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ,gBAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,EAAE;AACb;AACA;AACA;AACA,iCAAgC,cAAc;AAC9C;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sCAAqC,KAAK;AAC1C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;;;;;;;ACvIA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;;;;;;ACnBD;AACA;AACA;;AAEA;;AAEA;AACA;AACA,wBAAuB,OAAO;AAC9B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,cAAa;AACb;AACA;AACA;AACA;;AAEA;;;;;;;;AC3CA;;;;AAIA,OAAMA,OAAO,mBAAAC,CAAQ,GAAR,CAAb;AACA,OAAMC,KAAK,mBAAAD,CAAQ,EAAR,CAAX;AACA,OAAME,QAAQ,mBAAAF,CAAQ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","file":"/core/ui/bundle.js","sourcesContent":["/**\n * Control messages flow between bg and tabs\n * - bg messages are received by all tabs\n * - tab messages are received only by background\n * Internal msg format:\n * {\n *   name: {String}\n *   payload: {*}\n * }\n *\n * message - is transport layer, via chrome runtime\n * event - something that occurs and should be transferred\n */\n\nconst registeredListeners = new Map();\nconst registeredEvents = new Set();\n// todo: will not work for event-pages\nconst isBackgroundPage = chrome.extension.getBackgroundPage() === window;\n\n/**\n * Start listen messages\n *\n * @param {Object} [events] available events\n */\nexports.start = function (events) {\n  if (events) {\n    exports.registerEvents(events);\n  }\n  chrome.runtime.onMessage.addListener(onMessage);\n};\n\n/**\n * Register events\n */\nexports.registerEvents = function (events) {\n  if (Array.isArray(events)) {\n    events.forEach(key => registeredEvents.add(events[key]));\n  } else if (events && typeof events === 'object') {\n    Object.keys(events).forEach(key => registeredEvents.add(events[key]));\n  } else {\n    throw new Error('Events should be array or object to register');\n  }\n};\n\n/**\n * Send message from tab to bg OR visa-versa\n * @param {String} name\n * @param {*} payload\n */\nexports.send = function (name, payload) {\n  assertEventName(name);\n  const msg = wrapKnownMessage({name, payload});\n  return new Promise(resolve => {\n    chrome.runtime.sendMessage(msg, resolve);\n  });\n};\n\n/**\n * Add listener to message\n * @param {String} name\n * @param {Function} fn\n */\nexports.on = function (name, fn) {\n  assertEventName(name);\n  const msgListeners = registeredListeners.get(name) || [];\n  msgListeners.push(fn);\n  registeredListeners.set(name, msgListeners);\n};\n\nfunction onMessage(msg, sender, sendResponse) {\n  if (!isKnownMessage(msg)) {\n    return;\n  }\n\n  const fromTabToTab = sender.tab && !isBackgroundPage;\n  const fromBgToBg = !sender.tab && isBackgroundPage;\n  if (fromTabToTab || fromBgToBg) {\n    return;\n  }\n\n  assertEventName(msg.name);\n\n  const msgListeners = registeredListeners.get(msg.name);\n  if (msgListeners && msgListeners.length) {\n    let asyncResponse = false;\n    let result;\n    msgListeners.forEach(listener => {\n      try {\n        result = listener(msg.payload, sender, sendResponse);\n      } catch (e) {\n        // we need to re-throw error in next tick to be out of onMessage handler and allow event to bubble\n        // todo: try capture error stack\n        throwAsync(e);\n      }\n      if (result === true) {\n        asyncResponse = true;\n      }\n      if (isPromise(result)) {\n        asyncResponse = true;\n        result.then(\n          data => sendResponse(data),\n          e => sendResponse(e && e.stack || String(e))\n        );\n      }\n    });\n    // if at least some result is true or promise, we should return true\n    // to show that sendResponse will be called asynchroniously\n    return asyncResponse;\n  }\n}\n\nfunction assertEventName(name) {\n  if (!registeredEvents.has(name)) {\n    throw new Error(`Unknown event ${name}`);\n  }\n}\n\nfunction isKnownMessage(msg) {\n  return msg && msg.isMessaging;\n}\n\nfunction wrapKnownMessage(msg) {\n  return Object.assign(msg, {\n    isMessaging: true\n  });\n}\n\nfunction isPromise(obj) {\n  return obj && typeof obj.then === 'function';\n}\n\nfunction throwAsync(e) {\n  setTimeout(() => {\n    throw e;\n  }, 0);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils/messaging.js\n// module id = 24\n// module chunks = 1 4","/**\n * External events.\n * This file should be included in both bg and tab contexts.\n */\n\nconst keyMirror = require('keymirror');\n\n/**\n * List of all messages\n */\nmodule.exports = keyMirror({\n  // from tab\n  TESTS_RUN: null,\n  // from bg\n  RELOAD: null,\n  TESTS_DONE: null,\n  SESSION_STARTED: null,\n  FILE_STARTED: null,\n  TEST_STARTED: null,\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/background/external-events.js\n// module id = 25\n// module chunks = 1 4","/**\n * Simple console logger\n */\n\n/* eslint no-console: 0 */\n\nclass Logger {\n  constructor(prefix) {\n    this._prefix = `[${prefix}]:`;\n  }\n\n  log() {\n    this._callConsole('log', [].slice.call(arguments));\n  }\n\n  info() {\n    this._callConsole('info', [].slice.call(arguments));\n  }\n\n  warn() {\n    this._callConsole('warn', [].slice.call(arguments));\n  }\n\n  error() {\n    this._callConsole('error', [].slice.call(arguments));\n  }\n\n  _callConsole(method, args) {\n    console[method].apply(console, [this._prefix].concat(args));\n  }\n}\n\n/**\n * Helper to create logger right after require()\n * E.g. const logger = require('./logger').create('Module')\n *\n * @param {String} prefix\n * @returns {Logger}\n */\nLogger.create = function (prefix) {\n  return new Logger(prefix);\n};\n\nmodule.exports = Logger;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils/logger.js\n// module id = 88\n// module chunks = 1 4","/**\n * Main ui entry\n */\n\nconst mobx = require('mobx');\nconst fs = require('bro-fs');\nconst state = require('../state');\nconst {APP_STATE} = require('../state/constants');\nconst bgApi = require('./bg-api');\nconst windowApi = require('./window-api');\nconst testsRun = require('./tests-run');\nconst configLoader = require('./config-loader');\nconst htmlConsole = require('./html-console');\nconst setup = require('./setup');\nconst editor = require('./editor');\n\n/**\n * Start app\n */\nexports.start = function() {\n  htmlConsole.init();\n  testsRun.init();\n  configLoader.init();\n  editor.init();\n  bgApi.init();\n  windowApi.init();\n  return Promise.resolve()\n    .then(() => fs.init({type: window.PERSISTENT, requestQuota: false}))\n    .then(() => setup.applyOnFirstRun())\n    .then(() => state.load())\n    .then(mobx.action(ready));\n};\n\nfunction ready() {\n  state.appState = APP_STATE.READY;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/app.js","/**\n * Communication with bg page\n */\n\nconst messaging = require('../../utils/messaging');\nconst externalEvents = require('../../background/external-events');\nconst {\n  onTestsDone,\n  onSessionStarted,\n  onFileStarted,\n  onTestStarted,\n} = require('../controllers/internal-channels');\n\nconst {\n  RELOAD,\n  TESTS_RUN,\n  TESTS_DONE,\n  SESSION_STARTED,\n  FILE_STARTED,\n  TEST_STARTED,\n} = externalEvents;\n\nexports.init = function() {\n  messaging.registerEvents(externalEvents);\n  messaging.on(RELOAD, () => location.reload());\n  messaging.on(TESTS_DONE, () => onTestsDone.dispatch());\n  // todo: make this channeling in more automatic way (e.g. event flag isExternal: true)\n  messaging.on(SESSION_STARTED, data => onSessionStarted.dispatch(data));\n  messaging.on(FILE_STARTED, data => onFileStarted.dispatch(data));\n  messaging.on(TEST_STARTED, data => onTestStarted.dispatch(data));\n  messaging.start();\n};\n\nexports.runTests = function(data) {\n  return messaging.send(TESTS_RUN, data);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/bg-api.js","/**\n * API of window for programmatic run and other stuff\n */\n\nconst testsRun = require('./tests-run');\nconst htmlConsole = require('./html-console');\nconst setup = require('./setup');\n\n/**\n * Exports API to window\n */\nexports.init = function () {\n  Object.assign(window, {\n    /**\n     * Run custom tests on loopback chrome\n     *\n     * @param {Array<{path, code}>} tests\n     */\n    runTests: testsRun.runCustomSnippets,\n    /**\n     * Console implementation to show test logs in report\n     */\n    htmlConsole: htmlConsole.getInstance(),\n\n    resetDefaults: function () {\n      return setup.reset();\n    },\n\n    // for custom reporting\n    // todo: export module, not dom element\n    report: document.getElementById('report')\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/window-api.js","/**\n * Tests run controller\n */\n\nconst thenChrome = require('then-chrome');\nconst mobx = require('mobx');\nconst path = require('path');\nconst fs = require('bro-fs');\nconst state = require('../state');\nconst {APP_STATE, TAB} = require('../state/constants');\nconst bgApi = require('./bg-api');\nconst {onTestsRun, onTestsDone, onConsoleClear} = require('./internal-channels');\n\nexports.init = function () {\n  onTestsRun.addListener(runOnCurrentData);\n  onTestsDone.addListener(done);\n};\n\n/**\n * Run custom snippets\n *\n * @param {Array<{path, code}>} snippets\n */\nexports.runCustomSnippets = function(snippets) {\n  const data = {\n    target: getSelectedTargetInfo(),\n    snippets: snippets,\n    devMode: false,\n  };\n  run(data);\n};\n\nconst run = mobx.action(function (data) {\n  state.appState = APP_STATE.TESTS_RUNNING;\n  state.selectedTab = TAB.REPORT;\n  onConsoleClear.dispatch();\n  bgApi.runTests(data);\n});\n\nconst done = mobx.action(function () {\n  state.appState = APP_STATE.TESTS_DONE;\n  // activate self tab after tests done\n  activateSelfTab();\n});\n\nfunction runOnCurrentData() {\n  const data = {\n    target: getSelectedTargetInfo(),\n    baseUrl: getBaseUrl(),\n    files: getFiles(),\n    devMode: state.devMode,\n  };\n  if (state.isInnerFiles) {\n    getSnippets(data.baseUrl, data.files).then(snippets => {\n      data.snippets = snippets;\n      run(data);\n    });\n  } else {\n    run(data);\n  }\n}\n\nfunction getFiles() {\n  if (state.selectedFile) {\n    return state.files\n      .filter(file => file.isSetup)\n      .map(file => file.path)\n      .concat([state.selectedFile]);\n  } else {\n    return state.files.map(file => file.path);\n  }\n}\n\nfunction getBaseUrl() {\n  return state.isInnerFiles ? state.innerFilesPath : path.dirname(state.filesSourceUrl);\n}\n\nfunction getSnippets(basePath, paths) {\n  const tasks = paths.map(path => {\n    const fullPath = basePath + '/' + path;\n    return fs.readFile(fullPath)\n      .then(code => {\n        return {path, code};\n      });\n  });\n  return Promise.all(tasks);\n}\n\nfunction getSelectedTargetInfo() {\n  if (!state.selectedTarget) {\n    throw new Error('Empty target');\n  }\n  const hub = state.hubs.find(hub => hub.id === state.selectedTarget.hubId);\n  return {\n    serverUrl: hub.serverUrl,\n    watchUrl: hub.watchUrl,\n    loopback: hub.loopback,\n    name: state.selectedTarget.name,\n    caps: Object.assign({}, hub.caps, state.selectedTarget.caps),\n  };\n}\n\nfunction activateSelfTab() {\n  return thenChrome.tabs.getCurrent()\n    .then(tab => thenChrome.tabs.update(tab.id, {active: true}));\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/tests-run.js","\nconst Console = require('../../utils/console');\nconst {onConsoleMessage, onConsoleClear} = require('./internal-channels');\n\nlet instance = null;\n\nexports.init = function () {\n  instance = new Console();\n  instance.onMessage = data => onConsoleMessage.dispatch(data);\n  instance.onClear = () => onConsoleClear.dispatch();\n};\n\nexports.getInstance = function () {\n    return instance;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/html-console.js","/**\n * Implementation of console interface\n */\n\nconst stringifySafe = require('json-stringify-safe');\n\nconst MAX_INLINE_OBJ_LENGTH = 50;\n\nmodule.exports = class Console {\n  constructor() {\n    this._lines = [];\n    this.onMessage = () => {};\n    this.onClear = () => {};\n  }\n\n  log() {\n    const args = [].slice.call(arguments);\n    this._addLine('log', args);\n  }\n\n  info() {\n    const args = [].slice.call(arguments);\n    this._addLine('info', args);\n  }\n\n  warn() {\n    const args = [].slice.call(arguments);\n    this._addLine('warn', args);\n  }\n\n  error() {\n    const args = [].slice.call(arguments);\n    this._addLine('error', args);\n  }\n\n  clear() {\n    this._lines.length = 0;\n    this.onClear();\n  }\n\n  _addLine(type, args) {\n    args = args.map(formatArg);\n    const line = {type, args};\n    this._lines.push(line);\n    this.onMessage(line);\n  }\n};\n\nfunction formatArg(arg) {\n  switch (typeof arg) {\n    case 'object':\n      // todo: date and regexp\n      return arg === null ? formatNullUndefined() : formatString(stringifyObj(arg));\n    case 'function':\n      return formatString(arg.toString());\n    case 'number':\n      return formatNumber(arg);\n    case 'undefined':\n      return formatNullUndefined();\n    default:\n      return formatString(arg);\n  }\n}\n\nfunction formatNullUndefined(v) {\n  return {\n    type: 'null-undefined',\n    text: String(v),\n  };\n}\n\nfunction formatString(v) {\n  return {\n    type: 'string',\n    text: v,\n  };\n}\n\nfunction formatNumber(v) {\n  return {\n    type: 'number',\n    text: v,\n  };\n}\n\nfunction stringifyObj(obj) {\n  try {\n    let str = stringifySafe(obj, replacer, 2);\n    // for small objects use inline\n    if (str.length < MAX_INLINE_OBJ_LENGTH) {\n      str = stringifySafe(obj, replacer);\n    }\n    return str;\n  } catch(e) {\n    return obj.toString();\n  }\n}\n\n/**\n * Replace Date and Regexp in stringify\n *\n * @param {String} key\n * @param {*} value\n */\nfunction replacer(key, value) {\n  if (value instanceof Date) {\n    return value.toString();\n  } else if (value instanceof RegExp) {\n    return `/${value}/`;\n  } else {\n    return value;\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils/console.js\n// module id = 664\n// module chunks = 4","exports = module.exports = stringify\nexports.getSerialize = serializer\n\nfunction stringify(obj, replacer, spaces, cycleReplacer) {\n  return JSON.stringify(obj, serializer(replacer, cycleReplacer), spaces)\n}\n\nfunction serializer(replacer, cycleReplacer) {\n  var stack = [], keys = []\n\n  if (cycleReplacer == null) cycleReplacer = function(key, value) {\n    if (stack[0] === value) return \"[Circular ~]\"\n    return \"[Circular ~.\" + keys.slice(0, stack.indexOf(value)).join(\".\") + \"]\"\n  }\n\n  return function(key, value) {\n    if (stack.length > 0) {\n      var thisPos = stack.indexOf(this)\n      ~thisPos ? stack.splice(thisPos + 1) : stack.push(this)\n      ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key)\n      if (~stack.indexOf(value)) value = cycleReplacer.call(this, key, value)\n    }\n    else stack.push(value)\n\n    return replacer == null ? value : replacer.call(this, key, value)\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-stringify-safe/stringify.js\n// module id = 665\n// module chunks = 4","/**\n * Store some predefined data in first run\n * To clear storage run from console: chrome.storage.local.clear()\n */\n\nconst thenChrome = require('then-chrome');\nconst mobx = require('mobx');\nconst fs = require('bro-fs');\nconst defaults = require('../state/defaults');\nconst defaultsExtra = require('../state/defaults-extra');\nconst {PROJECTS_DIR} = require('../state/constants');\nconst logger = require('../../utils/logger').create('Setup');\n\nexports.applyOnFirstRun = function() {\n  return isFirstRun()\n    .then(firstRun => firstRun ? storeDefaults() : null);\n};\n\n/**\n * Resets local storage, filesystem and reloads ui\n */\nexports.reset = function() {\n  return Promise.all([\n    fs.clear(),\n    thenChrome.storage.local.clear(),\n  ])\n  .then(() => {\n    // setTimeout is usefull here for test client to get response from evaluated script before page reload\n    setTimeout(() => location.reload(), 50);\n  });\n};\n\n/**\n * Detects first run by checking `installDate` key in storage\n */\nfunction isFirstRun() {\n  return thenChrome.storage.local.get('installDate')\n    .then(data => Object.keys(data).length === 0);\n}\n\nfunction storeDefaults() {\n  return Promise.all([\n    storeToStorage(),\n    storeToFs(),\n  ]);\n}\n\nfunction storeToStorage() {\n  const data = mobx.toJS({\n    installDate: Date.now(),\n    projects: [defaults.project],\n    selectedProjectId: defaults.project.id,\n    targets: defaults.targets.concat(defaultsExtra.targets),\n    selectedTargetId: defaults.targets[0].id,\n    hubs: defaults.hubs.concat(defaultsExtra.hubs),\n    selectedTab: defaults.selectedTab,\n  });\n  logger.log(`Storing to storage`, data);\n  return thenChrome.storage.local.set(data);\n}\n\nfunction storeToFs() {\n  const path = `${PROJECTS_DIR}/${defaults.project.id}/${defaults.innerFile.path}`;\n  const content = defaults.innerFile.code;\n  logger.log(`Storing default inner file: ${path}`);\n  return fs.writeFile(path, content);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/setup.js","/**\n * Extra targets defined by buildInfo.isDev and process.env variables and applied in install controller\n */\n\nexports.hubs = [];\nexports.targets = [];\n\n// add localhost hub and target (currently for dev build only)\nif (buildInfo.isDev) {\n  exports.hubs = exports.hubs.concat([\n    {\n      id: 'localhost',\n      serverUrl: 'http://localhost:4444/wd/hub',\n      caps: {\n        'browserName': 'chrome'\n      }\n    },\n  ]);\n\n  exports.targets = exports.targets.concat([\n    {\n      id: 'localhost-1',\n      hubId: 'localhost',\n      name: 'Localhost server (chrome)',\n    },\n    {\n      id: 'localhost-2',\n      hubId: 'localhost',\n      name: 'Localhost server (firefox)',\n      caps: {\n        'browserName': 'firefox'\n      }\n    }\n  ]);\n}\n\n// add yandex hub and targets\nif (buildInfo.isDev && process.env.YANDEX_USER) {\n  exports.hubs = exports.hubs.concat([\n    {\n      id: 'yandex',\n      serverUrl: `http://${process.env.YANDEX_USER}:${process.env.YANDEX_KEY}@sg.yandex-team.ru:4444/wd/hub`,\n      caps: {\n        'browserName': 'chrome'\n      }\n    }\n  ]);\n\n  exports.targets = exports.targets.concat([\n    {\n      id: 'yandex-1',\n      hubId: 'yandex',\n      name: 'Yandex grid (chrome 51, linux)',\n      caps: {\n        'platform': 'LINUX',\n        'version' : '51.0',\n      }\n    },\n    {\n      id: 'yandex-2',\n      hubId: 'yandex',\n      name: 'Yandex grid (chrome 53, win7)',\n      caps: {\n        'platform': 'WINDOWS',\n        'version' : '53.0',\n      }\n    },\n  ]);\n}\n\n// add sauce hub and targets\nif (buildInfo.isDev && process.env.SAUCE_USER) {\n  exports.hubs = exports.hubs.concat([\n    {\n      id: 'sauce',\n      serverUrl: `http://${process.env.SAUCE_USER}:${process.env.SAUCE_KEY}@ondemand.saucelabs.com:80/wd/hub`,\n      watchUrl: `https://saucelabs.com/beta/tests/:sessionId/watch`,\n      caps: {\n        // temp for demo\n        'username': process.env.SAUCE_USER,\n        'accessKey': process.env.SAUCE_KEY,\n        'browserName': 'chrome'\n      }\n    }\n  ]);\n\n  exports.targets = exports.targets.concat([\n    {\n      id: 'sauce-1',\n      hubId: 'sauce',\n      name: 'Sauce labs (chrome stable, win7)',\n      caps: {\n        'platform': 'Windows 7',\n      }\n    },\n    {\n      id: 'sauce-2',\n      hubId: 'sauce',\n      name: 'Sauce labs (chrome beta, win7)',\n      caps: {\n        'platform': 'Windows 7',\n        'version': 'beta',\n      }\n    },\n    {\n      id: 'sauce-3',\n      hubId: 'sauce',\n      name: 'Sauce labs (firefox stable, win7)',\n      caps: {\n        'platform': 'Windows 7',\n        'browserName': 'firefox',\n      }\n    },\n  ]);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/state/defaults-extra.js","/**\n * Loads tests config from url\n */\n\nconst mobx = require('mobx');\nconst state = require('../state');\nconst {onError} = require('./internal-channels');\nconst {APP_STATE} = require('../state/constants');\nconst utils = require('../../utils');\nconst evaluate = require('../../utils/evaluate');\nconst logger = require('../../utils/logger').create('Config-loader');\n\n// todo: isLoading flag to reject parallel requests\n\n/**\n * Initially subscribe to changes of filesSourceUrl to reload config automatically\n */\nexports.init = function () {\n  mobx.reaction(() => state.filesSourceUrl, exports.load);\n};\n\n/**\n * Loads config from current url\n */\nexports.load = mobx.action(function () {\n  const url = state.filesSourceUrl;\n  if (utils.isValidUrl(url)) {\n    state.appState = APP_STATE.LOADING;\n    logger.log(`Loading config from: ${url}`);\n    return utils.fetchText(url)\n      .then(text => processConfig(text, url))\n      .then(done, fail);\n  } else {\n    fail(new Error(`Invalid config url ${url}`));\n  }\n});\n\nconst done = mobx.action(function (config) {\n  const setupFiles = config.setup.map(path => {\n    return {path, isSetup: true};\n  });\n  const regularFiles = config.tests.map(path => {\n    return {path, isSetup: false};\n  });\n  state.appState = APP_STATE.READY;\n  state.outerFiles = setupFiles.concat(regularFiles);\n  logger.log(`Config loaded:`, config);\n});\n\nconst fail = mobx.action(function(e) {\n  state.outerFiles = [];\n  state.appState = APP_STATE.READY;\n  // todo: store.clearTests();\n  onError.dispatch(e);\n});\n\nfunction processConfig(text, url) {\n  const config = evaluate.asCommonJs(url, text);\n  validateConfig(config);\n  return config;\n}\n\nfunction validateConfig(config) {\n  if (!config) {\n    throw new Error('Config is empty');\n  }\n  if (typeof config !== 'object') {\n    throw new Error('Config should be object');\n  }\n  if (!Array.isArray(config.setup)) {\n    config.setup = [];\n  }\n  if (!Array.isArray(config.tests)) {\n    config.tests = [];\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ui/controllers/config-loader.js","/**\n * Evaluate methods\n */\n\n/**\n * Evaluate code as commonJs module\n * Filename is required as otherwise you will not be able to debug code (<anonymous> in stack trace)\n *\n * @param {String} filename\n * @param {String} code\n */\nexports.asCommonJs = function (filename, code) {\n  const module = {exports: {}};\n  const args = {\n    module: module,\n    exports: module.exports,\n  };\n  const fnCode = code + '\\nreturn module;';\n  return exports.asFunction(filename, fnCode, args).exports;\n};\n\n/**\n * Evaluate code as anonymous function with specified arguments\n * Filename is required as otherwise you will not be able to debug code (<anonymous> in stack trace)\n *\n * @param {String} filename\n * @param {String} code\n * @param {Object} [args]\n * @param {Object} [context]\n */\nexports.asFunction = function (filename, code, args = {}, context = null) {\n  const argNames = Object.keys(args);\n  const argValues = argNames.map(name => args[name]);\n  const fn = new Function(argNames.join(','), code);\n  // for pretty debugging\n  Object.defineProperty(fn, 'name', {value: filename});\n  return fn.apply(context, argValues);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/utils/evaluate.js\n// module id = 669\n// module chunks = 4"],"sourceRoot":""}